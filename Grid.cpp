#include "Grid.hpp"

Grid::Grid() : grid {{'<', '!', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '!', '>'},
                    {'<', '!', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '!', '>'},
                    {'<', '!', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '!', '>'},
                    {'<', '!', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '!', '>'},
                    {'<', '!', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '!', '>'},
                    {'<', '!', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '!', '>'},
                    {'<', '!', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '!', '>'},
                    {'<', '!', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '!', '>'},
                    {'<', '!', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '!', '>'},
                    {'<', '!', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '!', '>'},
                    {'<', '!', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '!', '>'},
                    {'<', '!', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '!', '>'},
                    {'<', '!', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '!', '>'},
                    {'<', '!', '[', ']', '.', '.', '.', '.', '.', '.', '.', '.', '[', ']', '[', ']', '[', ']', '.', '.', '.', '.', '!', '>'},
                    {'<', '!', '.', '.', '.', '.', '[', ']', '[', ']', '[', ']', '[', ']', '.', '.', '.', '.', '.', '.', '.', '.', '!', '>'},
                    {'<', '!', '[', ']', '[', ']', '[', ']', '[', ']', '.', '.', '.', '.', '[', ']', '[', ']', '.', '.', '.', '.', '!', '>'},
                    {'<', '!', '[', ']', '[', ']', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '!', '>'},
                    {'<', '!', '.', '.', '.', '.', '.', '.', '.', '.', '[', ']', '[', ']', '[', ']', '[', ']', '.', '.', '.', '.', '!', '>'},
                    {'<', '!', '.', '.', '.', '.', '[', ']', '[', ']', '[', ']', '[', ']', '.', '.', '.', '.', '.', '.', '.', '.', '!', '>'},
                    {'<', '!', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '!', '>'},
                    {'<', '!', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '.', '[', ']', '[', ']', '!', '>'},
                    {'<', '!', '.', '.', '.', '.', '.', '.', '.', '.', '[', ']', '[', ']', '[', ']', '[', ']', '[', ']', '[', ']', '!', '>'},
                    {'<', '!', '.', '.', '.', '.', '[', ']', '[', ']', '.', '.', '.', '.', '[', ']', '[', ']', '.', '.', '.', '.', '!', '>'},
                    {'<', '!', '[', ']', '[', ']', '[', ']', '[', ']', '[', ']', '[', ']', '[', ']', '[', ']', '.', '.', '.', '.', '!', '>'},
                    {'<', '!', '.', '.', '.', '.', '[', ']', '[', ']', '[', ']', '[', ']', '.', '.', '.', '.', '[', ']', '[', ']', '!', '>'},
                    {'<', '!', '*', '*', '*', '*', '*', '*', '*', '*', '*', '*', '*', '*', '*', '*', '*', '*', '*', '*', '*', '*', '!', '>'},
                    {' ', ' ', '\\', '/', '\\', '/', '\\', '/', '\\', '/', '\\', '/', '\\', '/', '\\', '/', '\\', '/', '\\', '/', '\\', '/', ' ', ' '}} {};

char (*Grid::get_grid())[COLS] {
    return grid;
}

void Grid::draw_grid(WINDOW *win, int start_y, int start_x) {
    int init_start_x = start_x;
    for(int i = 0; i < ROWS; i++) {
        for(int j = 0; j < COLS; j++) {
            mvwprintw(win, start_y, start_x, "%c", grid[i][j]);
            start_x++;
        }
        start_x = init_start_x;
        start_y++;
    }
    wrefresh(win);
}

void Grid::check_grid(WINDOW *win) {
    bool full = true;
    for(int i = 0; i < ROWS-2; i++) {
        for(int j = 0; j < COLS; j++) {
            if(grid[i][j] == '.') {
                full = false;
            }
        }
        if(full) {
            delete_lines(win, i);
        }
        full = true;
    }
}

void Grid::delete_lines(WINDOW *win, int row) {
    int i, j;
    for(i = 0; i < row; i++) {
        for(j = 2; j < COLS-2; j++) {
            grid[i+1][j] = grid[i][j];
        }
    }
    for(j = 2; j < COLS-2; j++) {
        grid[0][j] = '.';
    }
    draw_grid(win, 0, 0);
}